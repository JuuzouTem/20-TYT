<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>20 Günlük Birleşik TYT Çalışma Programı</title>

    <!-- Firebase SDK (Software Development Kit) -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>

    <style>
        /* --- Genel Stiller ve Değişkenler (Referans Koddan Alındı) --- */
        :root {
            --bg-color: #1a1a2e;
            --card-color: #16213e;
            --primary-color: #0f3460;
            --accent-color: #e94560;
            --text-color: #e0e0e0;
            --text-muted-color: #a0a0c0;
            --success-color: #4CAF50;
            --border-color: rgba(224, 224, 224, 0.1);
            --shadow-color: rgba(0, 0, 0, 0.2);
            --font-family: 'Poppins', sans-serif;
        }

        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap');

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-family);
            background-color: var(--bg-color);
            color: var(--text-color);
            line-height: 1.6;
            padding: 20px;
        }

        /* --- Ana Konteyner --- */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            text-align: center;
            margin-bottom: 40px;
        }

        header h1 {
            font-size: 2.5rem;
            color: var(--text-color);
            margin-bottom: 10px;
            font-weight: 700;
        }

        header p {
            font-size: 1.1rem;
            color: var(--text-muted-color);
        }

        /* --- İstatistik Bölümü --- */
        .stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .stat-card {
            background-color: var(--card-color);
            padding: 20px;
            border-radius: 12px;
            border: 1px solid var(--border-color);
            box-shadow: 0 4px 15px var(--shadow-color);
        }

        .stat-card h3 {
            font-size: 1rem;
            color: var(--text-muted-color);
            margin-bottom: 10px;
            font-weight: 400;
        }

        .stat-card .value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--text-color);
        }

        .progress-bar {
            width: 100%;
            background-color: var(--primary-color);
            border-radius: 25px;
            margin-top: 15px;
            height: 10px;
            overflow: hidden;
        }

        .progress-bar-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--accent-color), #ff7e5f);
            border-radius: 25px;
            width: 0%;
            transition: width 0.5s ease-in-out;
        }

        /* --- Plan Bölümleri --- */
        .days-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        /* --- Gün Kartları --- */
        .day-card {
            background-color: var(--card-color);
            padding: 25px;
            border-radius: 12px;
            border: 1px solid var(--border-color);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .day-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px var(--shadow-color);
        }

        .day-card.completed {
            background-color: var(--primary-color);
            border-left: 5px solid var(--success-color);
        }
        
        .day-card.completed::after {
            content: '✔';
            position: absolute;
            top: 15px;
            right: 20px;
            font-size: 1.5rem;
            color: var(--success-color);
            opacity: 0.8;
        }

        .day-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .day-title {
            font-size: 1.5rem;
            font-weight: 600;
        }
        
        .day-card.completed .day-title,
        .day-card.completed .day-info p,
        .day-card.completed .day-progress {
            text-decoration: line-through;
            opacity: 0.7;
        }

        .day-info {
            flex-grow: 1; /* İçeriğin kartı doldurmasını sağlar */
        }

        .day-info p {
            margin-bottom: 8px;
            color: var(--text-muted-color);
            padding-left: 15px;
            position: relative;
        }
        
        .day-info p::before {
            content: '•';
            position: absolute;
            left: 0;
            color: var(--accent-color);
            font-weight: bold;
        }
        
        .day-info p strong {
            color: var(--text-color);
            font-weight: 600;
        }
        
        .day-info .finished-task {
            opacity: 0.6;
            font-style: italic;
        }
        
        .day-info .finished-task::before {
            color: var(--success-color);
        }

        .day-progress {
            font-style: italic;
            font-size: 0.9rem;
            color: var(--accent-color);
            margin-top: 15px;
            text-align: center;
            border-top: 1px solid var(--border-color);
            padding-top: 10px;
        }

        /* --- Özel Checkbox Stili --- */
        .checkbox-container {
            display: block;
            position: relative;
            cursor: pointer;
            font-size: 22px;
            user-select: none;
            width: 30px;
            height: 30px;
        }

        .checkbox-container input {
            position: absolute;
            opacity: 0;
            cursor: pointer;
            height: 0;
            width: 0;
        }

        .checkmark {
            position: absolute;
            top: 0;
            left: 0;
            height: 30px;
            width: 30px;
            background-color: var(--primary-color);
            border: 2px solid var(--border-color);
            border-radius: 8px;
            transition: background-color 0.2s;
        }

        .checkbox-container:hover input ~ .checkmark {
            background-color: #0f346099;
        }

        .checkbox-container input:checked ~ .checkmark {
            background-color: var(--success-color);
            border-color: var(--success-color);
        }

        .checkmark:after {
            content: "";
            position: absolute;
            display: none;
        }

        .checkbox-container input:checked ~ .checkmark:after {
            display: block;
        }

        .checkbox-container .checkmark:after {
            left: 9px;
            top: 5px;
            width: 8px;
            height: 12px;
            border: solid white;
            border-width: 0 3px 3px 0;
            transform: rotate(45deg);
        }

        /* --- YENİ EKLENEN KİMLİK DOĞRULAMA STİLLERİ --- */
        #auth-container { max-width: 400px; margin: 50px auto; padding: 30px; background-color: var(--card-color); border-radius: 12px; }
        #auth-container h2 { text-align: center; margin-bottom: 20px; color: var(--accent-color); }
        .form-group { margin-bottom: 15px; }
        .form-group label { display: block; margin-bottom: 5px; color: var(--text-muted-color); }
        .form-group input { width: 100%; padding: 10px; background-color: var(--primary-color); border: 1px solid var(--border-color); border-radius: 8px; color: var(--text-color); font-size: 1rem; }
        .btn { width: 100%; padding: 12px; border: none; border-radius: 8px; background-color: var(--accent-color); color: white; font-size: 1rem; font-weight: 600; cursor: pointer; transition: background-color 0.3s; }
        .btn:hover { background-color: #d83a56; }
        #auth-toggle { text-align: center; margin-top: 20px; color: var(--text-muted-color); }
        #auth-toggle a { color: var(--accent-color); text-decoration: none; cursor: pointer; }
        #auth-error { color: #ff5252; text-align: center; margin-top: 15px; display: none; }
        .hidden { display: none; }
        #logout-btn { width: auto; padding: 10px 20px; font-size: 0.9rem; background-color: var(--primary-color); border: 1px solid var(--accent-color); }
        #logout-btn:hover { background-color: var(--accent-color); }

    </style>
</head>
<body>

    <!-- GİRİŞ/KAYIT EKRANI -->
    <div id="auth-container">
        <!-- Giriş Formu -->
        <form id="login-form">
            <h2>Giriş Yap</h2>
            <p id="auth-error" class="error-message"></p>
            <div class="form-group">
                <label for="login-email">E-posta</label>
                <input type="email" id="login-email" required>
            </div>
            <div class="form-group">
                <label for="login-password">Şifre</label>
                <input type="password" id="login-password" required>
            </div>
            <button type="submit" class="btn">Giriş Yap</button>
            <p id="auth-toggle">Hesabın yok mu? <a id="show-signup">Kayıt Ol</a></p>
        </form>

        <!-- Kayıt Formu (Başlangıçta Gizli) -->
        <form id="signup-form" class="hidden">
            <h2>Kayıt Ol</h2>
            <p id="auth-error-signup" class="error-message"></p>
            <div class="form-group">
                <label for="signup-email">E-posta</label>
                <input type="email" id="signup-email" required>
            </div>
            <div class="form-group">
                <label for="signup-password">Şifre (En az 6 karakter)</label>
                <input type="password" id="signup-password" required>
            </div>
            <button type="submit" class="btn">Kayıt Ol</button>
            <p id="auth-toggle">Zaten bir hesabın var mı? <a id="show-login">Giriş Yap</a></p>
        </form>
    </div>

    <div class="container">
        <header>
            <h1>20 Günlük Birleşik TYT Çalışma Programı</h1>
            <p>Hedeflerine ulaşmak için her günü tamamla ve ilerlemeni gör!</p>
        </header>

        <section class="stats-container">
            <div class="stat-card">
                <h3>Genel İlerleme (Süre)</h3>
                <div class="value" id="total-time-value">0 / 4830 dk</div>
                <div class="progress-bar">
                    <div class="progress-bar-fill" id="total-time-progress"></div>
                </div>
            </div>
            <div class="stat-card">
                <h3>Tamamlanan Gün</h3>
                <div class="value" id="completed-days-value">0 / 20</div>
                <div class="progress-bar">
                    <div class="progress-bar-fill" id="completed-days-progress"></div>
                </div>
            </div>
            <div class="stat-card">
                <h3>Program Tamamlanma Yüzdesi</h3>
                <div class="value" id="completion-percentage-value">%0</div>
                <div class="progress-bar">
                    <div class="progress-bar-fill" id="completion-percentage-progress"></div>
                </div>
            </div>
        </section>
        
        <main>
             <div class="days-grid" id="plan-container">
                <!-- Gün kartları JavaScript ile buraya eklenecek -->
            </div>
        </main>

    </div>
    <script>

const firebaseConfig = {
  apiKey: "AIzaSyDmi3O8C1q58ESDyp2hE29YLhCqysc3rYs",
  authDomain: "tyt-programim-67d4f.firebaseapp.com",
  projectId: "tyt-programim-67d4f",
  storageBucket: "tyt-programim-67d4f.firebasestorage.app",
  messagingSenderId: "235629282000",
  appId: "1:235629282000:web:bd6cf1c4e88f0bc469d4d5"
};

    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();
    
    // --- GLOBAL DEĞİŞKENLER ---
    let currentUser = null; // Giriş yapmış kullanıcıyı tutacak
    let completedStatus = {}; // Kullanıcının ilerleme durumunu tutacak


    document.addEventListener('DOMContentLoaded', () => {
        
        // --- 20 GÜNLÜK BİRLEŞİK PLAN VERİLERİ ---
        // Not: Süreler dakika cinsinden girilmiştir.
        const planData = [
            { day: 1,  p: 35,  m: 260, f: 93,  total: 388, note: "~6 Saat 28 Dakika" },
            { day: 2,  p: 35,  m: 268, f: 89,  total: 392, note: "~6 Saat 32 Dakika" },
            { day: 3,  p: 35,  m: 289, f: 108, total: 432, note: "~7 Saat 12 Dakika" },
            { day: 4,  p: 35,  m: 255, f: 82,  total: 372, note: "~6 Saat 12 Dakika" },
            { day: 5,  p: 35,  m: 195, f: 96,  total: 326, note: "~5 Saat 26 Dakika" },
            { day: 6,  p: 35,  m: 252, f: 113, total: 400, note: "~6 Saat 40 Dakika" },
            { day: 7,  p: 35,  m: 228, f: 110, total: 373, note: "~6 Saat 13 Dakika" },
            { day: 8,  p: 30,  m: 200, f: 76,  total: 306, note: "~5 Saat 6 Dakika" },
            { day: 9,  p: 40,  m: 236, f: 108, total: 384, note: "~6 Saat 24 Dakika" },
            { day: 10, p: 40,  m: 187, f: 82,  total: 309, note: "~5 Saat 9 Dakika" },
            { day: 11, p: 45,  m: 176, f: 150, total: 371, note: "~6 Saat 11 Dakika (Matematik Bitti)" },
            { day: 12, p: 35,  m: 0,   f: 106, total: 141, note: "~2 Saat 21 Dakika" },
            { day: 13, p: 40,  m: 0,   f: 121, total: 161, note: "~2 Saat 41 Dakika (Paragraf Bitti)" },
            { day: 14, p: 0,   m: 0,   f: 92,  total: 92,  note: "~1 Saat 32 Dakika" },
            { day: 15, p: 0,   m: 0,   f: 116, total: 116, note: "~1 Saat 56 Dakika" },
            { day: 16, p: 0,   m: 0,   f: 70,  total: 70,  note: "~1 Saat 10 Dakika" },
            { day: 17, p: 0,   m: 0,   f: 89,  total: 89,  note: "~1 Saat 29 Dakika (Kimya Bitti)" },
            { day: 18, p: 0,   m: 0,   f: 85,  total: 85,  note: "~1 Saat 25 Dakika" },
            { day: 19, p: 0,   m: 0,   f: 78,  total: 78,  note: "~1 Saat 18 Dakika (Fizik Bitti)" },
            { day: 20, p: 0,   m: 0,   f: 57,  total: 57,  note: "~57 Dakika (PROGRAM BİTTİ!)" }
        ];

        const TOTAL_TIME = 4830; // 80 saat 30 dakika
        const TOTAL_DAYS = 20;

        let completedStatus = {};

        // --- DOM Elementleri ---
        const authContainer = document.getElementById('auth-container');
        const mainContainer = document.getElementById('main-container');
        const loginForm = document.getElementById('login-form');
        const signupForm = document.getElementById('signup-form');
        const showSignup = document.getElementById('show-signup');
        const showLogin = document.getElementById('show-login');
        const logoutBtn = document.getElementById('logout-btn');
        const authError = document.getElementById('auth-error');
        const authErrorSignup = document.getElementById('auth-error-signup');
        const planContainer = document.getElementById('plan-container');
        const totalTimeValue = document.getElementById('total-time-value');
        const completedDaysValue = document.getElementById('completed-days-value');
        const completionPercentageValue = document.getElementById('completion-percentage-value');
        const totalTimeProgress = document.getElementById('total-time-progress');
        const completedDaysProgress = document.getElementById('completed-days-progress');
        const completionPercentageProgress = document.getElementById('completion-percentage-progress');

        // --- KİMLİK DOĞRULAMA İŞLEMLERİ ---

        // Formlar arası geçiş
        showSignup.addEventListener('click', () => {
            loginForm.classList.add('hidden');
            signupForm.classList.remove('hidden');
        });
        showLogin.addEventListener('click', () => {
            signupForm.classList.add('hidden');
            loginForm.classList.remove('hidden');
        });

        // Kayıt Olma
        signupForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const email = signupForm['signup-email'].value;
            const password = signupForm['signup-password'].value;
            auth.createUserWithEmailAndPassword(email, password).catch(err => {
                authErrorSignup.textContent = err.message;
                authErrorSignup.style.display = 'block';
            });
        });

        // Giriş Yapma
        loginForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const email = loginForm['login-email'].value;
            const password = loginForm['login-password'].value;
            auth.signInWithEmailAndPassword(email, password).catch(err => {
                authError.textContent = err.message;
                authError.style.display = 'block';
            });
        });

        // Çıkış Yapma
        logoutBtn.addEventListener('click', () => {
            auth.signOut();
        });

        // Kullanıcı durumunu dinle (Giriş/Çıkış)
        auth.onAuthStateChanged(user => {
            if (user) {
                // Kullanıcı giriş yaptı
                currentUser = user;
                authContainer.classList.add('hidden');
                mainContainer.classList.remove('hidden');
                loadProgressFromFirestore(); // Firestore'dan verileri yükle
            } else {
                // Kullanıcı çıkış yaptı
                currentUser = null;
                mainContainer.classList.add('hidden');
                authContainer.classList.remove('hidden');
                // UI'ı temizle
                planContainer.innerHTML = '';
            }
        });

        // --- FONKSİYONLAR ---

        function saveProgressToFirestore() {
            if (!currentUser) return;
            db.collection('users').doc(currentUser.uid).set({
                progress: completedStatus
            }).catch(err => console.error("Veri kaydetme hatası: ", err));
        }

        async function loadProgressFromFirestore() {
            if (!currentUser) return;
            const docRef = db.collection('users').doc(currentUser.uid);
            const doc = await docRef.get();

            if (doc.exists && doc.data().progress) {
                completedStatus = doc.data().progress;
            } else {
                // Yeni kullanıcı için başlangıç durumu oluştur
                planData.forEach(day => completedStatus[day.day] = false);
                saveProgressToFirestore(); // Veritabanında ilk kaydı oluştur
            }
            // Veriler yüklendikten sonra UI'ı başlat
            initializeAppUI();
        }

        function updateStats() {
            let completedTime = 0, completedDays = 0;
            planData.forEach(day => {
                if (completedStatus[day.day]) {
                    completedTime += day.total;
                    completedDays++;
                }
            });
            const timePercent = (completedTime / TOTAL_TIME) * 100;
            const daysPercent = (completedDays / TOTAL_DAYS) * 100;
            totalTimeValue.textContent = `${completedTime} / ${TOTAL_TIME} dk`;
            completedDaysValue.textContent = `${completedDays} / ${TOTAL_DAYS}`;
            completionPercentageValue.textContent = `%${daysPercent.toFixed(0)}`;
            totalTimeProgress.style.width = `${timePercent}%`;
            completedDaysProgress.style.width = `${daysPercent}%`;
            completionPercentageProgress.style.width = `${daysPercent}%`;
        }
        
        function updateUICards() {
             document.querySelectorAll('.day-card').forEach(card => {
                 const day = card.dataset.day;
                 if (completedStatus[day]) {
                     card.classList.add('completed');
                     card.querySelector('input[type="checkbox"]').checked = true;
                 } else {
                     card.classList.remove('completed');
                     card.querySelector('input[type="checkbox"]').checked = false;
                 }
             });
        }

        function renderPlan() {
            let html = '';
            planData.forEach(day => {
                let tasksHtml = '';
                if (day.p > 0) {
                    tasksHtml += `<p><strong>Paragraf:</strong> ${day.p} Dakika</p>`;
                } else if (day.day > 13) {
                     tasksHtml += `<p class="finished-task"><strong>Paragraf:</strong> Tamamlandı</p>`;
                }

                if (day.m > 0) {
                    tasksHtml += `<p><strong>Matematik:</strong> ${day.m} Dakika</p>`;
                } else if (day.day > 11) {
                     tasksHtml += `<p class="finished-task"><strong>Matematik:</strong> Tamamlandı</p>`;
                }

                if (day.f > 0) {
                    tasksHtml += `<p><strong>Fen Bilimleri:</strong> ${day.f} Dakika</p>`;
                } else if (day.day > 20) {
                     tasksHtml += `<p class="finished-task"><strong>Fen Bilimleri:</strong> Tamamlandı</p>`;
                }


                html += `
                    <div class="day-card" data-day="${day.day}">
                        <div class="day-header">
                            <h3 class="day-title">${day.day}. Gün</h3>
                            <label class="checkbox-container">
                                <input type="checkbox" data-day="${day.day}">
                                <span class="checkmark"></span>
                            </label>
                        </div>
                        <div class="day-info">
                            ${tasksHtml}
                        </div>
                        <p class="day-progress">Günlük Toplam Süre: ${day.note}</p>
                    </div>
                `;
            });
            planContainer.innerHTML = html;
        }

        function handleCheckboxClick(e) {
            if (e.target.matches('input[type="checkbox"]')) {
                const day = e.target.dataset.day;
                completedStatus[day] = e.target.checked;
                saveProgressToFirestore(); // Değişikliği anında veritabanına kaydet
                updateStats();
                updateUICards();
            }
        }

        // --- BAŞLATMA ---
        function init() {
            loadProgress();
            renderPlan();
            updateStats();
            updateUICards();
            planContainer.addEventListener('click', handleCheckboxClick);
        }

        init();
    });
    </script>
</body>
</html>